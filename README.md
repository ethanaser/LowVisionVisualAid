#本仓库用于托管ME111A（壁羽智能助视器M48Q）项目源代码
#开发工具
AndroidStudio 4.0.1
#开发语言
Android OpenGL ES 少量kotlin 少量jni
#当前版本
v1.0.3
#当前Git最新分支
release_v1.0.3
#开源库使用
USBCamera--------https://github.com/saki4510t/UVCCamera
基于这个库进行了部分修改：延时优化，切换摄像头优化，插拔优化，本地库：git clone https://Zhy_em3@bitbucket.org/leisong03/uvccamera.git
申请git账号拉进去就可以了
#软件功能概览
--基础功能：
----1.缩放（按照一定倍数对图像进行放大）
----2.定格（冻结图像）
----3.中心放大（取中心部分图像,在缩放的基础上局部放大）
----4.模式切换（使用OpenGL ES 对原图像的颜色模式进行切换 重点是两色描边 使用边缘检测技术实现）
----5.快速放大（在缩放的基础上恢复到1倍大小，使用中心红框定位中心视野位置，再恢复到原倍数进行观察）
----6.OCR识别（百度OCR文字识别解析图片中的文字，使用讯飞TTS读出来）
----7.蓝牙连接（连接蓝牙遥控器（HID蓝牙设备连接），使用遥控器操作设备，蓝牙耳机目前测试无法使用，因为会有系统配对弹窗，无法操作）
--菜单功能：
----11.眼部情况->瞳距（同时调整左右两个图像之间的距离，参数可以用按键重置。目前看来与真实瞳距并无联系，后面是否需要联系上需要大量测试来确认）
----12.眼部情况->视野调节（单独调节某一侧图像的位置，应对斜视类似的眼部情况）
----13.眼部情况->基础缩放（单独缩放左右的图像大小，应对大小眼的眼部问题）
----14.眼部情况->管状视野（同时缩放左右图像的大小，应对管状视野的眼部问题，与基础缩放有功能上的冲突，最终使用不同缩放倍数下不同缩放步长实现为最终缩小到相同的倍数）
----21.图像设置->亮度（调整VR设备屏幕亮度，目前该功能屏蔽，因为调节亮度时设备不稳定，会导致输出设备重启的问题）
----22.图像设置->饱和度（OpenGL ES 调节图像的饱和度）
----23.图像设置->对比度（OpenGL ES 调节图像的对比度）
----24.图像设置->两色模式色彩（在多种颜色中选取一个颜色作为两色模式的显示颜色）
----25.图像设置->描边模式色彩（在多种颜色中选取一个颜色作为描边模式的显示颜色）
----26.图像设置->文字字号（修改文字字号显示，会调整提示信息和菜单的大小，功能实现了，总感觉有点乱，后面看看是否优化）
----27.图像设置->防抖（在高倍数放大情况下，头部的微小抖动也会被放大，该功能使用opencv的光流追踪技术实现将抖动平滑处理，不过延时较高）
----31.语音设置->语速调节（调整TTS读文字的速度）
----32.语音设置->音量调节（调整系统音量，改变TTS读文字的音量）
----41.相册->相册（显示用户拍照保存的图像，使用VR设备的IMU数据实现3DOF模式，用四元数的x y值对图像进行偏移（偏移相机位置frustum lookat））
----51.基础设置->WIFI连接（使用扫描二维码的模式连接WIFI（二维码中包含的是wifi的sid 和 password））
----52.基础设置->节能（使用VR设备上的PSensor（佩戴传感器）来检测眼镜设备是否正在使用，如果未使用就在某个时刻关闭一些功能来降低能耗）
----53.基础设置->黑黄模式（切换菜单和提示信息的文字图标颜色）
----54.基础设置->机器码（设备的MAC地址）
----61.重置设置->重置设置（将所有参数恢复到初始状态）
----71.软件更新->软件更新（后台更新，安装使用厂商提供的静默安装）
----81.说明书->说明书（对设备的一些辅助说明，目前使用图片显示的内容，后面是否需要更换待定，图片目前固定放在assets下）
----91.其他->灯光频闪，ISO曝光，对焦，视场角（由摄像头厂商决定），延时（修改libusbcamera库的解码次数来降低延时，目前使用IFrameCallback来获取摄像头数据）
----92.其他->语音优先级，低电量提示
----93.其他->参数记忆 （sharepreference保存参数信息，重启时应用）
----94.其他->各种软件硬件的稳定性测试
----95.其他->遥控器按键（A-定格,B-上,C-下,D-左,E-右,F-确认,G-快速放大,H-返回,I-菜单,J-放大,K-缩小）
----96.其他->主机按键（音量+-放大，连接蓝牙，音量--缩小，HOME-home键回到主界面）
#软件设计
1.CuiNiaoApp（Application 初始化各种工具）
-1.YUVModeActivity
--11.YuvGLSurfaceView（主界面的GLSurfaceView,用于OpenGL绘制图像）
---111.RGBRenderer（主要用于绘制图像的类，对图像的所有操作都在这个类里面，偏移，缩放，颜色模式切换，定格）
----1111.FastZoomScale（快速放大，快速缩小）
----1112.CenterScale（中心放大）
--12.GamePadManager（蓝牙连接工具类，使用Kotlin编写的代码）
---121.HidReceiver（蓝牙HID设备（输入设备）连接）
----1211.BlueConnectThread（HID设备连接实际连接类，写道子线程总是连接不到设备，目前未知原因）
--13.CNSJCamera（USBCamera相机连接类，里面包含相机开启关闭预览关闭预览等相机的基础操作，目前使用双摄像头显示图像，摄像头单开，在1.5倍和2倍时切换摄像头显示）
---131.IFrameCallback（主要用于接受底层返回的相机帧数据，目前返回RGB565数据）
---132.USBMonitor.UsbControlBlock（USB摄像头的硬件数据信息相关）
--14.GlassesService.MyBinder--observer（连接USB设备配置的服务类，内部对设备的PID,VID进行筛选使用，内部包含与VR设备通信的接口）
---141.NeptungSensor（VR设备通信接口，适配的xgvr-release.aar，厂商的设备通信包）
---142.USBMonitor（USB设备连接类，包含USB设备连接断连通信等各个接口，适配的libusbcamera库）
--15.OnEyesChangeListener（主界面UI分左右两个部分，图像位置变换时，主界面UI也要跟随变化 UI随动功能）
--16.CustomMenuPopup，CustomMenuPopupTwo，CustomMenuPopupThree（三个级别的菜单显示，主要用于上面软件参数的配置）
--17.baseItemList（菜单中各个参数设置项的集合，BaseItem封装了每个参数的通用操作，剩下每个参数项特殊配置由各个参数项自行定义）
--18.notifyViewChange--ViewObserver（用于回调图像位置变化，通知到菜单里面同步进行位置更新）
--19.showPromptNoDissmiss（用于显示不消失的提示内容；蓝牙连接，保存图片）
--20.showPrompt（用于显示消失的提示内容：缩放...）
--21.onKeyDown,onKeyUp（各种按键操作）
--22.Controller（用于对实时图像进行操作的控制类）
-2.UVCCamera（第三方库libusbcamera封装的底层USB摄像头操作类）
-3.native-lib.cpp（用于实现防抖功能的源文件---OpenCVView，内部使用光流追踪技术实现，网上有很多现成的案例）
-4.关于节能功能的实现:目前方案为检测到未佩戴设备时，降低能耗（关闭摄像头，最直接的方式）。
